Summary,Issue key,Issue id,Issue Type,Status,Project key,Project name,Project type,Project lead,Project description,Project url,Priority,Resolution,Assignee,Reporter,Creator,Created,Updated,Last Viewed,Resolved,Affects Version/s,Fix Version/s,Component/s,Due Date,Votes,Description,Environment,Work Ratio,Security Level,Custom field (Acceptance Test - Add?),Custom field (Acceptance Test - Entry),Custom field (Epic Link),Custom field (Expected Effort),Custom field (Ignite Forum URL),Custom field (Rank),Custom field (Support Plan Customer Issue),Comment,Comment,Comment
Cross Site Scripting (XSS) issues - CSW Document No: C1055,OF-1963,24120,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,gdt,gdt,gdt,02/05/20 10:38 PM,03/06/20 02:18 PM,03/21/20 04:13 PM,03/06/20 02:18 PM,4.5.1,4.5.2,Admin Console,,0,"Numerous XSS issues have been identified by CyberSecurityWorks, document number C1055.",,,,No,,,,,"0|i01ca7:",No,,,
SystemProperty should load classes with Thread.getContextClassloader as fallback,OF-1964,24121,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,csh,csh,csh,02/11/20 12:31 PM,02/11/20 03:02 PM,03/21/20 04:13 PM,02/11/20 03:02 PM,4.5.1,4.5.2,,,0,"The new class {{SystemProperty}} causes issues, when loading classes which are contained in a plugin.

In our specific case we have a custom {{LockOutProvider}} implementation in a plugin and set this class:

{code}
LockOutManager.LOCKOUT_PROVIDER.setValue(PluginLockoutProvider.class);
{code}

The class cannot be found, because {{SystemProperty}} is loaded by the App ClassLoader, which doesn't see plugin classes, because {{Class.forName()}} only checks the SystemProperty's classloader.

This is a regression, earlier versions of {{LockoutManager}} used the {{ClassUtils}} to load LockoutProviders.

The fix is trivial: {{SystemProperty}} should use {{ClassUtils.forName()}} instead of {{Class.forName()}}, so that {{Thread.getContextClassLoader()}} is used as fallback.

{noformat}
java.lang.ClassNotFoundException: PluginLockoutProvider
        at java.net.URLClassLoader.findClass(URLClassLoader.java:471) ~[?:?]
        at java.lang.ClassLoader.loadClass(ClassLoader.java:588) ~[?:?]
        at java.lang.ClassLoader.loadClass(ClassLoader.java:521) ~[?:?]
        at java.lang.Class.forName0(Native Method) ~[?:?]
        at java.lang.Class.forName(Class.java:315) ~[?:?]
        at org.jivesoftware.util.SystemProperty.lambda$static$10(SystemProperty.java:101) ~[xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.SystemProperty.getValue(SystemProperty.java:305) [xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.SystemProperty$1.propertySet(SystemProperty.java:198) [xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.PropertyEventDispatcher.dispatchEvent(PropertyEventDispatcher.java:87) [xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.JiveProperties.put(JiveProperties.java:302) [xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.JiveGlobals.setProperty(JiveGlobals.java:833) [xmppserver-4.5.1.jar:4.5.1]
        at org.jivesoftware.util.SystemProperty.setValue(SystemProperty.java:357) [xmppserver-4.5.1.jar:4.5.1]

{noformat}
",,,,No,,,,,"0|i01caf:",No,"02/11/20 12:58 PM;csh;PR: https://github.com/igniterealtime/Openfire/pull/1578","02/11/20 02:03 PM;gdt;Thanks - I've merged this PR - do you need in in the 4.5.x branch too?","02/11/20 02:57 PM;csh;Thanks, would be nice, of coure ;-)"
ConcurrentModificationException while loading plugins,OF-1972,24130,Bug,Open,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,,guus,guus,guus,03/13/20 09:41 AM,03/13/20 09:42 AM,03/21/20 04:13 PM,,4.5.1,,Plugins,,0,"??While testing Openfire 4.5.1 with a rather large set of Openfire plugins, we hit the situation that an ConcurrentModificationException occurred in the loading process of the plugins. The direct result is some corruption in the server state, which blocks the loading of other plugins and the server not responding. Restarting does not help either.??

??The exception is thrown when in line org.jivesoftware.openfire.container.PluginManager:379 the pluginsLoaded map is looped in order to get a an entry.??

??It is easy to imagine this should happen: the plugins are loaded simultaneously, using a unsynchronised map to add and retrieve data from it. The question is why nobody has reported this problem before.??",,,,No,,,,https://discourse.igniterealtime.org/t/concurrent-modification-exception-is-thrown-by-the-plugin-manager-during-startup/,"0|i01ccf:",No,,,

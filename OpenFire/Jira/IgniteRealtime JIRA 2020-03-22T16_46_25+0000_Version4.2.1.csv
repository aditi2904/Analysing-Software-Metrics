Summary,Issue key,Issue id,Issue Type,Status,Project key,Project name,Project type,Project lead,Project description,Project url,Priority,Resolution,Assignee,Reporter,Creator,Created,Updated,Last Viewed,Resolved,Affects Version/s,Affects Version/s,Fix Version/s,Component/s,Component/s,Due Date,Votes,Labels,Description,Environment,Work Ratio,Security Level,Outward issue link (Related to),Custom field (Acceptance Test - Add?),Custom field (Acceptance Test - Entry),Custom field (Epic Link),Custom field (Expected Effort),Custom field (Ignite Forum URL),Custom field (Rank),Custom field (Support Plan Customer Issue),Comment,Comment,Comment,Comment,Comment
An unexpected exception occurred with loading clustering plugin,OF-1453,22449,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,gdt,akrherz,akrherz,12/09/17 03:22 AM,11/26/18 03:48 PM,03/22/20 04:45 PM,11/26/18 03:48 PM,4.2.1,,4.3.0,Plugins,,,0,,"user provided logs of Openfire 4.2.1 attempting to load old clustering plugin over and over again every 20 seconds without stopping
{code}
2017.12.08 12:17:23 ERROR [pool-4-thread-1]: org.jivesoftware.openfire.container.PluginMonitor - An unexpected exception occurred:
java.util.concurrent.ExecutionException: java.lang.NullPointerException: Plugin could not be located: clustering
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask.run(PluginMonitor.java:310)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: Plugin could not be located: clustering
	at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:484)
	at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:440)
	at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:424)
	at org.jivesoftware.admin.AdminConsole.getAdminText(AdminConsole.java:207)
	at org.jivesoftware.openfire.container.PluginMetadataHelper.getName(PluginMetadataHelper.java:149)
	at org.jivesoftware.openfire.container.PluginMetadata.getInstance(PluginMetadata.java:103)
	at org.jivesoftware.openfire.container.PluginManager.loadPlugin(PluginManager.java:403)
	at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:276)
	at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:264)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	... 3 more
{code}",,,,,No,,,,https://discourse.igniterealtime.org/t/openfire-4-2-0-login-issues-check-your-database-schema/79916/27,"0|i017qn:",No,"12/12/17 03:54 PM;guus;I'm guessing that this problem is caused by a plugin directory (in which the plugin was previously expanded) that still exists, but has no, or partial, content. Perhaps a failed uninstallation, caused by objects still being referenced in memory, preventing from libraries being deleted, or file-permission problems.","03/26/18 10:39 AM;Kyoshiro;I had a similar issue after updating from 4.1.6 to 4.2.3 today, using .deb Debian package.

The plugin directory contained an obsolete plugin called hazelcast and tried to load it in a loop before starting listeners on 5223 port.
Admin console was working properly though.
{noformat}
2018.03.26 09:44:20 ERROR [pool-4-thread-1]: org.jivesoftware.openfire.container.PluginMonitor - An unexpected exception occurred:
java.util.concurrent.ExecutionException: java.lang.NullPointerException: Plugin could not be located: hazelcast
        at java.util.concurrent.FutureTask.report(FutureTask.java:122)
        at java.util.concurrent.FutureTask.get(FutureTask.java:192)
        at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask.run(PluginMonitor.java:310)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: Plugin could not be located: hazelcast
        at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:484)
        at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:440)
        at org.jivesoftware.util.LocaleUtils.getLocalizedString(LocaleUtils.java:424)
        at org.jivesoftware.admin.AdminConsole.getAdminText(AdminConsole.java:207)
        at org.jivesoftware.openfire.container.PluginMetadataHelper.getName(PluginMetadataHelper.java:149)
        at org.jivesoftware.openfire.container.PluginMetadata.getInstance(PluginMetadata.java:103)
        at org.jivesoftware.openfire.container.PluginManager.loadPlugin(PluginManager.java:403)
        at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:276)
        at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:264)
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)
        ... 3 more{noformat}
After removing / moving away /var/lib/openfire/plugins/\{hazelcast,hazelcast.jar}, server started properly.

Kind regards.","03/26/18 01:16 PM;akrherz;@Kyoshiro, thanks for chiming in.  To clarify, if you update the plugin via the admin console, this issue goes away and clustering works fine?","03/26/18 01:29 PM;Kyoshiro;In fact we weren't using that plugin nor clustering anymore, and it did not show up in the plugin list on the admin console.
It must have been an aborted attempt for clustering.

Anyways, the server wouldn't properly startup until hazelcast directory and jar file were actually removed from /var/lib/openfire/plugins directory.

After removing, clients were able to connect to the server.","06/08/18 12:59 PM;gdt;FWIW, I'm seeing something very similar to this very intermittently with Openfire 4.2.3 on Windows. It seems to happen either more often, or perhaps only ever, when a new plugin has been installed and needs unpacking. My suspicion is that, in my case at least, the AV on the machine in question is preventing access from the Openfire process to a newly created file while it's still being AV scanned, causing this issue.  If it happened more reliably I'd have an attempt at trying to diagnose it better!

Greg
{code:java}
2018.06.08 12:44:38 ERROR [pool-4-thread-1]: org.jivesoftware.openfire.container.PluginMonitor - An unexpected exception occurred:
java.util.concurrent.ExecutionException: java.lang.NullPointerException
at java.util.concurrent.FutureTask.report(FutureTask.java:122)
at java.util.concurrent.FutureTask.get(FutureTask.java:192)
at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask.run(PluginMonitor.java:310)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException
at java.util.TreeMap.rotateRight(TreeMap.java:2250)
at java.util.TreeMap.fixAfterInsertion(TreeMap.java:2287)
at java.util.TreeMap.put(TreeMap.java:582)
at org.jivesoftware.openfire.container.PluginManager.loadPlugin(PluginManager.java:404)
at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:276)
at org.jivesoftware.openfire.container.PluginMonitor$MonitorTask$4.call(PluginMonitor.java:264)
at java.util.concurrent.FutureTask.run(FutureTask.java:266)
... 3 more
{code}"
Openfire Hazelcast Clustering & REST API Room Creation NPE when no modificationDate sent,OF-1474,22535,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,gdt,gdt,02/08/18 08:43 AM,04/11/18 11:18 AM,03/22/20 04:46 PM,04/11/18 11:18 AM,4.2.1,,4.3.0,MUC,,,0,,"Using Openfire 4.2.x, when the hazelcast and REST API Plugins, clustered(2+ nodes),

*Overview*
Creating Room via REST API partially fails
The Room is created, but without the Room Description and Topic correctly populated
As well, the room state event is not sent to the other members of the cluster

*Pre-conditions*
Openfire clustering turned on
More than 1 node in the cluster
Create a room via REST API w/o the modificationDate

*Result*:

The Room is created, but without the Room Description and Topic correctly populated
Null Pointer Exception in the logs, upon trying to send the room updated event out to the cluster. It is making the assumption that the modifiedDate is not null … and boom

{{// LocalMUCRoom.writeExternal, line 2726 ExternalizableUtil.getInstance().writeLong(out, modificationDate.getTime());}}

 

{{Caused by: java.lang.NullPointerException at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.writeExternal(LocalMUCRoom.java:2726) at org.jivesoftware.openfire.muc.cluster.RoomUpdatedEvent.writeExternal(RoomUpdatedEvent.java:62) at java.io.ObjectOutputStream.writeExternalData(ObjectOutputStream.java:1459)}}

Work-arounds
 # Turn off nodes 2 and 3 for Openfire, but leave Hazelcast running on node 1
 # Short-term work-around in the REST API call to create the room, also populate and send the modificationDate . Continue running in clustered mode, with multiple nodes.
 # Fix the 1 line bug in Openfire, with a null check

 ",,,,,No,,,,https://discourse.igniterealtime.org/t/openfire-hazelcast-clustering-rest-api-room-creation-npe-when-no-modificaitondate-sent/80619,"0|i0180f:",No,,,,,
Can't update plugins via Admin Console,OF-1464,22470,Bug,Closed,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,wroot,wroot,01/07/18 05:45 PM,03/24/18 08:07 AM,03/22/20 04:46 PM,02/14/18 08:04 PM,4.2.1,,4.2.3,Admin Console,Plugins,,0,plugins,"Trying to update Registration and User Status plugins via Admin Console. Logs show this:
{code:java}
2018.01.07 19:40:41 WARN [Jetty-QTP-AdminConsole-35]: org.directwebremoting.extend.Call - No methods called 'downloadPlugin' in NewCreator for org.jivesoftware.openfire.update.PluginDownloadManager are applicable for the passed parameters.
{code}",,,,,No,,,,,"0|i017vb:",No,"01/07/18 05:45 PM;wroot;Can install and uninstall plugins. Just can't update.","01/07/18 05:47 PM;wroot;Was able to remove User Status plugin and install new version again.","02/13/18 08:25 PM;wroot;4.2.2 same. So far a workaround is to delete the plugin and install it again (via Admin Console).",,
Users are not getting Access to contacts PubSub nodes if contacts are added via WebInterface,OF-1489,22550,Bug,Open,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,,dwd,vanitasvitae,vanitasvitae,02/19/18 01:23 PM,02/19/18 06:20 PM,03/22/20 04:46 PM,,4.2.1,,,PubSub,,,0,,"A user in open_chat reported, that he doesn't have access to some contacts OMEMO keys. Those contacts were added via the webinterface of OpenFire.

Other contacts had keys available. Those were added via the client (Conversations).

This suggests, that the WebInterface does not give a user access to a contacts pubsub nodes when the contact gets added to the users roster via the webinterface.",,,,,No,,,,,"0|i0183r:",No,"02/19/18 06:20 PM;guus;The original reporter of the issue mentioned this in open_chat earlier:

(19:10) vladimir: i was make it.. omemo now work fine. but i don't know bug it or not
(19:10) yulise has joined the room
(19:15) vladimir: solution for users, who was added from webface of OpenFire (corporate group):
1. usubscribe receive status of second user at first
2. unsubscribe receive status of first user at second
3. subscribe receive status of second user at first (confirm it at second user)
4. subscribe receive status of first user at second (confirm it at first user)
5. reconnect booth client
6. select OMEMO and then Conversations will request keys from user
7. all fine. if not - do same with deleting keys before reconnect.
(19:16) vladimir: i think is not bug, because users, who added ofer webface can't have omemo keys, but have subscribes
(19:17) vladimir: but solution is true. really work",,,,
LDAP auth fails with clustering plugin ,OF-1480,22541,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,gdt,gdt,gdt,02/12/18 01:22 PM,02/13/18 03:58 PM,03/22/20 04:46 PM,02/13/18 03:58 PM,4.2.0,4.2.1,4.2.2,Clustering,LDAP,,0,,"From the group chat;

{{2018.02.12 13:35:29 DEBUG [Jetty-QTP-AdminConsole-33]: org.jivesoftware.util.Log -}}
{{org.jivesoftware.openfire.auth.UnauthorizedException: com.hazelcast.nio.serialization.HazelcastSerializationException: Failed to serialize 'org.jivesoftware.openfire.ldap.LdapManager$DNCacheEntry'}}
{{at org.jivesoftware.openfire.ldap.LdapAuthProvider.authenticate(LdapAuthProvider.java:126)}}
{{at org.jivesoftware.openfire.auth.AuthFactory.authenticate(AuthFactory.java:203)}}

 

Cursory glance indicates that LdapManager$DNCacheEntry does not implement serializable ...

 ",,,,OF-1306,No,,,,,"0|i0181r:",No,"02/12/18 02:50 PM;gdt;Caching was introduced in 4.2.0 with OF-1306, but unfortunately the cache was not serialisable so does not work in a cluster.",,,,
ClassCast Exception on admin console sessions listing when running hazelcast,OF-1460,22462,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,akrherz,akrherz,01/03/18 02:01 PM,01/24/18 01:38 PM,03/22/20 04:46 PM,01/24/18 01:38 PM,4.2.1,,4.2.2,,,,0,,Running hazelcast and Openfire 4.2.1 results in a ClassCastException on the admin console sessions listing.  See forum post for more details,,,,,No,,,,https://discourse.igniterealtime.org/t/bug-openfire-admin-show-sessions-problem-hazelcast-openfire-4-2-x/80076,"0|i017tj:",No,,,,,
WebSocket endpoint should allow null path,OF-1470,22526,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,Fixed,csh,akrherz,akrherz,01/26/18 01:46 PM,01/26/18 01:46 PM,03/22/20 04:46 PM,01/26/18 01:46 PM,4.2.1,,4.2.2,Core,,,0,,"Currently the endpoint is only available via ws://host:port/ws/

It will now also be available via ws://host:port/ws

(note the lack of the trailing slash).

URLs without trailing slash seem to be the standard for BOSH and WebSockets and are also used by XEP-0156.

This commit increases interoperability.

 

https://github.com/igniterealtime/Openfire/pull/1000",,,,,No,,,,,"0|i017yf:",No,,,,,

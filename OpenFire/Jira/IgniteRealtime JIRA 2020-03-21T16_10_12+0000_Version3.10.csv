Summary,Issue key,Issue id,Issue Type,Status,Project key,Project name,Project type,Project lead,Project description,Project url,Priority,Resolution,Assignee,Reporter,Creator,Created,Updated,Last Viewed,Resolved,Affects Version/s,Affects Version/s,Affects Version/s,Affects Version/s,Affects Version/s,Fix Version/s,Fix Version/s,Component/s,Due Date,Votes,Labels,Labels,Labels,Labels,Labels,Description,Environment,Work Ratio,Security Level,Outward issue link (Related to),Custom field (Acceptance Test - Add?),Custom field (Acceptance Test - Entry),Custom field (Epic Link),Custom field (Expected Effort),Custom field (Ignite Forum URL),Custom field (Rank),Custom field (Support Plan Customer Issue),Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment
NIOConnection Thread Deadlock when two clients in each others roster simultaneously disconnect,OF-881,20132,Bug,Closed,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Blocker,Fixed,tevans,akrherz,akrherz,2/14/2015 14:54,1/7/2016 16:20,3/21/2020 16:09,11/17/2015 0:00,3.10.0,,,,,3.10.3,4.0.0,Core,,0,,,,,," In testing the latest 3.10.0 Beta from the Github repository, a thread deadlock issue has been encountered.
 
The issue apparently occurs when two users, each with the other on their Roster, disconnect from the server at the same time.
 
Below is the relevant thread dump output for the deadlock situation:
 
-----------------------------------
{code} 
""C2S-Thread-2"":
  at org.jivesoftware.openfire.nio.NIOConnection.isClosed(NIOConnection.java:249)
  - waiting to lock <0x0000000094e3e540> (a org.jivesoftware.openfire.nio.NIOConnection)
  at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:257)
  at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession .java:857)
  at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
  at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableI mpl.java:354)
  at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.jav a:239)
  at org.jivesoftware.openfire.roster.Roster.broadcastPresence(Roster.java:609)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(Presenc eUpdateHandler.java:308)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:162)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:137)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:201)
  at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
  at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
  at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
  at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClos e(SessionManager.java:1183)
  at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection. java:237)
  at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:219)
  - locked <0x0000000094e47a98> (a org.jivesoftware.openfire.nio.NIOConnection)
  at org.jivesoftware.openfire.nio.ConnectionHandler.sessionClosed(ConnectionHandler .java:115)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionClosed( DefaultIoFilterChain.java:793)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.core.filterchain.IoFilterAdapter.sessionClosed(IoFilterAdapter. java:88)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.filter.codec.ProtocolCodecFilter.sessionClosed(ProtocolCodecFil ter.java:367)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:109)
  at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(Ordere dThreadPoolExecutor.java:769)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(Order edThreadPoolExecutor.java:761)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThr eadPoolExecutor.java:703)
  at java.lang.Thread.run(Thread.java:745)
 {code}
-----------------------
 {code}
""C2S-Thread-3"":
  at org.jivesoftware.openfire.nio.NIOConnection.isClosed(NIOConnection.java:249)
  - waiting to lock <0x0000000094e47a98> (a org.jivesoftware.openfire.nio.NIOConnection)
  at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:257)
  at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession .java:857)
  at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
  at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableI mpl.java:354)
  at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.jav a:239)
  at org.jivesoftware.openfire.roster.Roster.broadcastPresence(Roster.java:609)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(Presenc eUpdateHandler.java:308)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:162)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:137)
  at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateH andler.java:201)
  at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
  at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
  at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
  at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClos e(SessionManager.java:1183)
  at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection. java:237)
  at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:219)
  - locked <0x0000000094e3e540> (a org.jivesoftware.openfire.nio.NIOConnection)
  at org.jivesoftware.openfire.nio.ConnectionHandler.sessionClosed(ConnectionHandler .java:115)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionClosed( DefaultIoFilterChain.java:793)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.core.filterchain.IoFilterAdapter.sessionClosed(IoFilterAdapter. java:88)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.filter.codec.ProtocolCodecFilter.sessionClosed(ProtocolCodecFil ter.java:367)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(Def aultIoFilterChain.java:504)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterC hain.java:500)
  at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed (DefaultIoFilterChain.java:923)
  at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:109)
  at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(Ordere dThreadPoolExecutor.java:769)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(Order edThreadPoolExecutor.java:761)
  at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThr eadPoolExecutor.java:703)
  at java.lang.Thread.run(Thread.java:745)
 {code}
-----------------------
 
A possible solution is to refactor the NIOConnection.close method, to invoke notifyCloseListeners() after the synchronized block.  This is also how the method was arranged in Openfire versions at least as recent as 3.7.
 
Below is a refactored version of the method:
 
{code}
    public void close() {
    synchronized(this) {
    if (isClosed()) {
    return;
    }
            try {
                deliverRawText(flashClient ? ""</flash:stream>"" : ""</stream:stream>"", false);
            } catch (Exception e) {
                // Ignore
            }
            if (session != null) {
                session.setStatus(Session.STATUS_CLOSED);
            }
            closed = true;
          
            // commented, moved to after the synchronized block.
            // notifyCloseListeners(); // clean up session, etc.
    }
 
    // moved from within the synchronized block.
    notifyCloseListeners(); // clean up session, etc.
 
        ioSession.close(false); // async via MINA
    }
{code}",,,,,No,,,,https://community.igniterealtime.org/message/245826?tstart=0#245826,0|i012dj:,No,"11/13/15 08:40 PM;tevans;Having another go at this one, based on this thread: https://community.igniterealtime.org/message/253342",11/17/15 12:00 AM;tevans;Submitted [PR #374|https://github.com/igniterealtime/Openfire/pull/374].,"11/17/15 05:13 PM;akrherz;Tom, running 3.10 branch on Ignite and things seem to be OK.  I do notice a fair number of these messages logged

{code}
2015.11.17 11:04:19 org.jivesoftware.openfire.net.SocketConnection - Failed to deliver stream close tag: Socket closed
{code}

At about a rate ~30 per hour.","11/17/15 06:19 PM;tevans;OK - that message indicates a ""normal"" error condition (dropped peer). Although benign, it should probably be a bit more helpful, and likely a debug message rather than an error. I will patch in the master branch for future release.","01/07/16 04:20 PM;timd;Re-tested in Openfire 4.0.0 (nightly (5th Jan)) and could not replicate. 

Note: Found jstack useful in assessing deadlock state:
{code}
jstack -F `pgrep java` | less
{code}",,,,,,,
NPE on Admin Console (client sessions listing),OF-889,20147,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Blocker,Fixed,dwd,akrherz,akrherz,3/6/2015 14:44,10/2/2015 15:56,3/21/2020 16:10,6/15/2015 12:47,3.10.0,,,,,3.10.1,,Admin Console,,1,,,,,,"Using a 19 Feb build of Openfire on Ignite, the following NPE was seen attempting to view active client sessions on the Admin console

{code}
java.lang.NullPointerException
        at org.jivesoftware.openfire.nio.NIOConnection.getHostAddress(NIOConnection.java:166)
        at org.jivesoftware.openfire.session.LocalSession.getHostAddress(LocalSession.java:362)
        at org.jivesoftware.openfire.admin.session_002dsummary_jsp._jspService(session_002dsummary_jsp.java:500)
        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:800)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1669)
        at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)
        at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
        at org.jivesoftware.util.LocaleFilter.doFilter(LocaleFilter.java:74)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
        at org.jivesoftware.util.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:50)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
        at org.jivesoftware.admin.PluginFilter.doFilter(PluginFilter.java:78)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
        at org.jivesoftware.admin.AuthCheckFilter.doFilter(AuthCheckFilter.java:159)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
        at org.eclipse.jetty.server.Server.handle(Server.java:497)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:245)
        at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
        at java.lang.Thread.run(Thread.java:745)
{code}",,,,,No,,,,,0|i012cn:,No,"05/26/15 01:13 PM;guus;As it's hard to reproduce this locally, I've pushed a change that splits off all chained method calls. This non-functional change should help us identify what code is causing the NPE. Note that in future stack traces, the line numbering is expected to be different than the one logged in the description of this issue.","05/26/15 07:53 PM;akrherz;Updated trace with Guus's commit

{code}
java.lang.NullPointerException
	at org.jivesoftware.openfire.nio.NIOConnection.getHostAddress(NIOConnection.java:173)
	at org.jivesoftware.openfire.session.LocalSession.getHostAddress(LocalSession.java:367)
	at org.jivesoftware.openfire.admin.session_002dsummary_jsp._jspService(session_002dsummary_jsp.java:510)
	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:808)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1669)
	at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)
	at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.util.LocaleFilter.doFilter(LocaleFilter.java:74)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.util.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.admin.PluginFilter.doFilter(PluginFilter.java:78)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.admin.AuthCheckFilter.doFilter(AuthCheckFilter.java:159)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:497)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)
	at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
	at java.lang.Thread.run(Thread.java:745)
{code}",06/10/15 06:56 PM;akrherz;Moving this to a blocker as it is currently reproducible by Andi and with current dev code.,"07/10/15 08:16 AM;ruisimoes;Unfortunately still have the same problem.

Server: Ubuntu Server 14.04.2
Openfire 3.11.0 Alfa (with last build ""1558"")

the log:

2015.07.10 07:50:34 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <iq type=""set"" id=""120-53892"" to=""tondela@10.3.0.2/centrauto""><query xmlns=""jabber:iq:roster""><item jid=""clobos1@10.3.0.2"" name=""Camara de Lobos - Pedidos Lojas (Octavio R)"" subscription=""to""><group>Lojas JPLR</group></item></query></iq>
2015.07.10 07:50:34 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:318)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:290)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.SessionManager.userBroadcast(SessionManager.java:1068)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:685)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:718)
        at org.jivesoftware.openfire.roster.Roster.<init>(Roster.java:163)
        at org.jivesoftware.openfire.roster.RosterManager.getRoster(RosterManager.java:116)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(PresenceUpdateHandler.java:307)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:162)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClose(SessionManager.java:1242)
        at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection.java:294)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:277)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:226)
        at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:398)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:248)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:226)
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:355)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:290)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.SessionManager.userBroadcast(SessionManager.java:1068)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:685)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:718)
        at org.jivesoftware.openfire.roster.Roster.<init>(Roster.java:163)
        at org.jivesoftware.openfire.roster.RosterManager.getRoster(RosterManager.java:116)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(PresenceUpdateHandler.java:307)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:149)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.net.StanzaHandler.processPresence(StanzaHandler.java:348)
        at org.jivesoftware.openfire.net.ClientStanzaHandler.processPresence(ClientStanzaHandler.java:101)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:265)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:187)
        at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:177)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:690)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:407)
        at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:236)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
        at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
        at java.lang.Thread.run(Thread.java:745)

end of log ----------------------------------------------------------------------------------------------------------------------
the openfire stop some times and I need to restart but i dont know if it because of this problem.

Thanks.","08/11/15 08:33 AM;mack;Still gave this issue:

CentOS 7
OpenFire: openfire-3.10.2 (updated from 3.10.1)

java version ""1.8.0_45""
Java(TM) SE Runtime Environment (build 1.8.0_45-b14)
Java HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)


{code:java}
2015.08.11 08:28:38 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.NullPointerException
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:356)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.roster.Roster.broadcastPresence(Roster.java:609)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(PresenceUpdateHandler.java:308)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:162)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.net.StanzaHandler.processPresence(StanzaHandler.java:348)
        at org.jivesoftware.openfire.net.ClientStanzaHandler.processPresence(ClientStanzaHandler.java:100)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:265)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:187)
        at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:177)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:690)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:407)
        at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:236)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:417)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1200(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:765)
        at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
        at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
        at java.lang.Thread.run(Unknown Source)
{code}
","10/02/15 03:56 PM;palvati;it has been stated that the issue has been resolved on this issue, yet I do not see how the issue was fixed or what I do to fix it

Today I was reinstalling openfire on different server and had the same issue as reported on this case while installing it on Windows 2012 server with openfire_3_10_2 and I’m having current error while connecting the new server to active directory.  All individual test have passed, yet I get the error when I click on save & continue on step 3 of 3

Can you please inform me on how to solve this problem or if that is only fixed on the linux version? 

Please advise. 


http://127.0.0.1:9090/setup/setup-admin-settings.jsp?ldap=true  (IE)

HTTP ERROR 500
Problem accessing /setup/setup-admin-settings.jsp. Reason: 
    Server Error
Caused by:
java.lang.NullPointerException
	at org.jivesoftware.openfire.admin.setup.setup_002dadmin_002dsettings_jsp._jspService(setup_002dadmin_002dsettings_jsp.java:99)
	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:808)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1669)
	at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)
	at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.util.LocaleFilter.doFilter(LocaleFilter.java:74)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.util.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.admin.PluginFilter.doFilter(PluginFilter.java:78)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.jivesoftware.admin.AuthCheckFilter.doFilter(AuthCheckFilter.java:159)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:497)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)
	at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
	at java.lang.Thread.run(Unknown Source)
________________________________________
Powered by Jetty://
________________________________________


",,,,,,
Deadlock with MINA sslFilter,OF-916,20342,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Blocker,Fixed,dwd,akrherz,akrherz,6/10/2015 17:44,6/16/2015 17:14,3/21/2020 16:10,6/16/2015 17:14,3.10.0,,,,,3.10.1,,Core,,0,,,,,,"Current 3.10.1 RC is plagued with a deadlock that happens when a client logs out or some other action that may be triggering this.  Below is a snippet of a thread dump

{code}
""NioProcessor-6"" #81 prio=5 os_prio=0 tid=0x00007f4d14009000 nid=0x3ca2 waiting for monitor entry [0x00007f4df77f5000]
   java.lang.Thread.State: BLOCKED (on object monitor)
	at org.apache.mina.filter.ssl.SslFilter.filterClose(SslFilter.java:662)
	- waiting to lock <0x00000000c15a4108> (a org.apache.mina.filter.ssl.SslHandler)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callPreviousFilterClose(DefaultIoFilterChain.java:644)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$9(DefaultIoFilterChain.java:640)

""C2S-Thread-3"" #82 daemon prio=5 os_prio=0 tid=0x00007f4c8c001800 nid=0x3ca3 waiting for monitor entry [0x00007f4df76f4000]
   java.lang.Thread.State: BLOCKED (on object monitor)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:221)
	- waiting to lock <0x00000000c15b79b8> (a org.jivesoftware.openfire.nio.NIOConnection)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:212)
	at org.jivesoftware.openfire.session.LocalSession.close(LocalSession.java:346)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:145)
{code}

While googling around, I found this: https://issues.apache.org/jira/browse/DIRMINA-1012

Which has an interesting comment that the sslFilter needs to come before the threaded Executor.  dwd made a patch and testing looks good so far!

https://github.com/dwd/Openfire/commit/202f85381e3a70c245c7fa38898e140e225cfea7",,,,,No,,,,,0|i012af:,No,06/16/15 05:14 PM;akrherz;we are hopeful that this is fixed in 3.10.1,,,,,,,,,,,
High CPU usage and hangup after a few days of running,OF-883,20138,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Blocker,Fixed,dwd,wroot,wroot,2/20/2015 20:01,6/16/2015 17:13,3/21/2020 16:10,6/16/2015 17:13,3.10.0,,,,,3.10.1,,,,11,cpu,hang,overload,process,windows,"A few users running 3.10.0 Beta report 100% CPU usage of Openfier process after a few days of running (no similar problems with previous versions of Openfire). They have to kill the process in the Task manager. No related logs. At first it was an impression that some left over files (from version 3.9.3) were causing that, but even after a clean install the issue persists. At least one user reports he is using built-in Java 7.

More reports after the GA release:
https://community.igniterealtime.org/thread/55306
https://community.igniterealtime.org/thread/55251","Windows Server 2008 R2, MS SQL, Mac OS X with Java 8",,,OF-421,No,,,,https://community.igniterealtime.org/message/245972,0|i012d3:,No,"04/27/15 10:41 AM;it2000;Could be the same problem as the one described in http://permalink.gmane.org/gmane.comp.apache.mina.user/5062 (Mina 2.0.7). Setting the system property ""-Djava.net.preferIPv4Stack=true"" did help.",04/28/15 03:59 AM;wroot;There are at least 3 more users in the thread that has the issue fixed by adding that setting (disabling IPv6 support). So this is probably a bug in the MINA which surfaced after the MINA update in 3.10.0 (OF-421).,"05/05/15 11:53 AM;fzachlod;This is definitely NOT solved by adding -Djava.net.preferIPv4Stack=true.

We observe this too since we upgraded from 3.9.3 to 3.10.0.

Platform: Debian Wheezy amd64, java version ""1.7.0_79""
OpenJDK Runtime Environment (IcedTea 2.5.5) (7u79-2.5.5-1~deb7u1)
OpenJDK 64-Bit Server VM (build 24.79-b02, mixed mode)

external postgresql server, active directory integration. Some times the server crashes 6 times a day some times it will run for 3 days before locking up. We too are observing one or two cores at 100%. No one is being able to connect to the server at this moment. Possibly related to OF-881 ??? We receive such messages too. Not shure if it might be related.

{code}2015.05.05 13:18:20 org.jivesoftware.openfire.session.LocalSession - Interner Serverfehler
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:264)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354{code}

This is our cpu usage you will clearly notice the date I upgraded the server software:

https://drive.google.com/file/d/0B79C-rd-LZm5c3gwc3VmTDBLZkU/view?usp=sharing

This is REALLY rendering our openfire instance useless. Does anyone have a clue how one can downgrade to 3.9.3 without restoring old backups file by file?

{code}ps aux | grep java
openfire 15614  3.9 12.5 997296 128844 ?       Sl   13:49   0:23 /usr/lib/jvm/java-7-openjdk-amd64/bin/java -Djava.net.preferIPv4Stack=true -server -DopenfireHome=/usr/share/openfire -Dopenfire.lib.dir=/usr/share/openfire/lib -classpath /usr/share/openfire/lib/startup.jar -jar /usr/share/openfire/lib/startup.jar{code}

willing to provide additional details... please let me know which u need

temporary (really bad) workaround:

{code}while true; do if [[ $(mpstat -u 60 1 | grep Average | awk '{print int($11)}') -le 10 ]]; then /etc/init.d/openfire restart; fi; done &{code}","05/05/15 09:12 PM;dwd;Thanks, that log data is really useful - does your server federate with remote domains, or are all your users ""local"" to Openfire (ie, not from remote domains)?","05/06/15 07:16 AM;fzachlod;This server has only local users. All users and groups are imported from (and authenticated against) active directory windows server 2008. We use roster sharing between users. Users connect using different clients, including Pidgin, Miranda, Trillian, Gaim, Xabber. Possibly some users have external Jabber contacts, the corresponding ports are open to the internet so anyone is free to communicate to the rest of the world :-)

Sometimes I see connection refused messages corresponding to an external xmpp server. Might be there are orphan contacts in someone's contact list which cannot be reached anymore.

By the way almost every working day at around half past 8 A.M. we observe the server crashing this is the time the most users arrive @ work and start up their computers and automatically connect to their jabber account.

What I am wondering is

- that the error log mentions ""Interner Serverfehler"" which is translated to German although there are no German locales installed on this machine

LANG=en_US.UTF-8
LANGUAGE=en_US:en
LC_CTYPE=""en_US.UTF-8""
LC_NUMERIC=""en_US.UTF-8""
LC_TIME=""en_US.UTF-8""
LC_COLLATE=""en_US.UTF-8""
LC_MONETARY=""en_US.UTF-8""
LC_MESSAGES=""en_US.UTF-8""
LC_PAPER=""en_US.UTF-8""
LC_NAME=""en_US.UTF-8""
LC_ADDRESS=""en_US.UTF-8""
LC_TELEPHONE=""en_US.UTF-8""
LC_MEASUREMENT=""en_US.UTF-8""
LC_IDENTIFICATION=""en_US.UTF-8""
LC_ALL=

for me this indicates it might be passed from another server?!

- The error messages look like this:

{code}2015.05.06 10:26:52 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <iq type=""set"" id=""670-2179"" to=""user@domain/resource""><query xmlns=""jabber:iq:roster""><item jid=""otheruser@domain"" name=""Other User"" subscription=""to""><group>OT-GROUPNAME </group></item></query></iq>
2015.05.06 10:26:52 org.jivesoftware.openfire.session.LocalSession - Interner Serverfehler
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:264)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.SessionManager.userBroadcast(SessionManager.java:1068)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:685)
        at org.jivesoftware.openfire.roster.Roster.broadcast(Roster.java:718)
        at org.jivesoftware.openfire.roster.Roster.<init>(Roster.java:163)
        at org.jivesoftware.openfire.roster.RosterManager.getRoster(RosterManager.java:116)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(PresenceUpdateHandler.java:307)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:162)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClose(SessionManager.java:1242)
        at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection.java:240)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:222)
        at org.jivesoftware.openfire.session.LocalSession.close(LocalSession.java:346)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:145)
        at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:189)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:854)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:405)
        at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:235)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.compression.CompressionFilter.messageReceived(CompressionFilter.java:155)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.ssl.SslHandler.flushScheduledEvents(SslHandler.java:319)
        at org.apache.mina.filter.ssl.SslFilter.messageReceived(SslFilter.java:520)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
        at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
        at java.lang.Thread.run(Thread.java:745){code}

Please note the following: the group's name should be ""OT-GROUPNAME"" but indeed is shown as ""OT-GROUPNAME "" (this is followed by a space character which is NOT included in the attribute provided by the ldap server.

It is ovious that these errors show up when the server gets into trouble. What I don't know is are these cause or are these effect of the problem.","05/06/15 09:34 AM;wroot;May i ask moving this discussion to the forums thread dedicated to this issue? Usually we want to use comments here for some important stages of work on the ticket. Do not want a clutter of investigating comments here. Also, every edit of a comment here generates another mail notification. My inbox is flooded because if that :) ","05/26/15 08:09 PM;guus;26-05-15 20:25:17) michael: maybe an strace could help? strace -f -p PID or better strace -f -o /tmp/output.txt -p PID
(26-05-15 20:38:17) michael: ok, I did a closer look with strace and lsof. It look like openfire tries to read from TCP connections in the state CLOSE_WAIT. Output from lsof on the TCP connection 239:
{code}
java    763 openfire  239u  IPv4             321478      0t0      TCP jabber.server.de:xmpp-client->jabber.client.de:58589 (CLOSE_WAIT)
(26-05-15 20:39:56) michael: strace of the high load thread shows:
1826  <... epoll_wait resumed> {{EPOLLIN, {u32=241, u64=38654705905}}, {EPOLLIN, {u32=239, u64=14771914748958081263}}, {EPOLLIN, {u32=247, u64=10272278160926048503}}, {EPOLLIN, {u32=249, u64=10272278160926048505}}, {EPOLLIN, {u32=58, u64=10272278160926048314}}, {EPOLLIN, {u32=252, u64=10272278160926048508}}}, 4096, 1000) = 6
1826  gettimeofday( <unfinished ...>
1826  <... gettimeofday resumed> {1432664741, 159417}, NULL) = 0
1826  read(239,  <unfinished ...>
1826  <... read resumed> """", 1024)      = 0
1826  read(252,  <unfinished ...>
1826  <... read resumed> """", 512)       = 0
1826  read(58,  <unfinished ...>
1826  <... read resumed> """", 128)       = 0
1826  read(247,  <unfinished ...>
1826  <... read resumed> """", 512)       = 0
1826  read(249,  <unfinished ...>
1826  <... read resumed> """", 128)       = 0
1826  read(241,  <unfinished ...>
1826  <... read resumed> """", 128)       = 0
1826  gettimeofday( <unfinished ...>
1826  <... gettimeofday resumed> {1432664741, 159927}, NULL) = 0
1826  gettimeofday( <unfinished ...>
1826  <... gettimeofday resumed> {1432664741, 160001}, NULL) = 0
1826  gettimeofday( <unfinished ...>
1826  <... gettimeofday resumed> {1432664741, 160073}, NULL) = 0
1826  epoll_wait(49,  <unfinished ...>
1826  <... epoll_wait resumed> {{EPOLLIN, {u32=241, u64=38654705905}}, {EPOLLIN, {u32=239, u64=14771914748958081263}}, {EPOLLIN, {u32=247, u64=10272278160926048503}}, {EPOLLIN, {u32=249, u64=10272278160926048505}}, {EPOLLIN, {u32=58, u64=10272278160926048314}}, {EPOLLIN, {u32=252, u64=10272278160926048508}}}, 4096, 1000) = 6
1826  gettimeofday( <unfinished ...>
1826  <... gettimeofday resumed> {1432664741, 160225}, NULL) = 0
1
{code}
(26-05-15 20:39:57) Guus: michael: does that correspond with a thread that's spinning up to 100% cpu?
(26-05-15 20:40:03) michael: jup","05/28/15 07:08 PM;akrherz;Some related MINA issues found by Guus and others

https://issues.apache.org/jira/browse/DIRMINA-785
https://issues.apache.org/jira/browse/DIRMINA-1001","05/28/15 09:09 PM;guus;MINA 2.0.8 introduces support for half-duplex close of TCP channels (see [https://issues.apache.org/jira/browse/DIRMINA-785]). As part of this change, IoHandlers got a new method. The default behavior of the IoHandlerAdapter closes the MINA session when this handler is triggered. However, without an Openfire-specific extension (in ConnectionHandler), this fails to close Openfire-maintained resources. As a result, CPUs could start to spin in NIO code, resulting in 100% CPU cycles.

To fix this issue, ConnectionHandler now overrides the default functionality and triggers a normal closure of the session (both in Openfire as well as MINA context).

Additionally, to prevent the CPU spin, MINA sessions need to be closed synchronously (as opposed to the async closure Openfire had up until now). I cannot quite explain the need for this change, other than a suspision of race conditions in the async setup.","05/29/15 06:57 AM;guus;This morning, the session summary admin page displays this the following stack trace. This loop should be prevented. Note that the changes mentioned above had already been applied when this error occurred.

{code}java.lang.StackOverflowError
	at java.security.AccessController.doPrivileged(Native Method)
	at java.io.PrintWriter.<init>(PrintWriter.java:116)
	at java.io.PrintWriter.<init>(PrintWriter.java:100)
	at org.apache.log4j.spi.VectorWriter.<init>(ThrowableInformation.java:80)
	at org.apache.log4j.spi.ThrowableInformation.getThrowableStrRep(ThrowableInformation.java:58)
	at org.apache.log4j.spi.LoggingEvent.getThrowableStrRep(LoggingEvent.java:342)
	at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:304)
	at org.apache.log4j.RollingFileAppender.subAppend(RollingFileAppender.java:236)
	at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)
	at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)
	at org.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)
	at org.apache.log4j.Category.callAppenders(Category.java:203)
	at org.apache.log4j.Category.forcedLog(Category.java:388)
	at org.apache.log4j.Category.log(Category.java:853)
	at org.slf4j.impl.Log4jLoggerAdapter.debug(Log4jLoggerAdapter.java:285)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:367)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:373)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:225)
	at org.jives",,
"c2s stop responding, new connections hang ",OF-857,20024,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Blocker,Fixed,tevans,akrherz,akrherz,12/5/2014 22:13,1/16/2015 17:42,3/21/2020 16:10,1/16/2015 17:42,3.10.0,,,,,3.10.0,,Core,,0,,,,,,"Currently, some recent change has led to client connections getting 'jammed'  with Openfire.  Openfire will continue to function, outside of c2s connections.  Ignite's openfire instance is reproducing this issue daily.  Some interesting log entries

{code}
2014.11.21 06:42:00 org.jivesoftware.openfire.net.SASLAuthentication - SASLAuthentication: SaslException
javax.security.sasl.SaslException: DIGEST-MD5: digest response format violation. Mismatched URI: xmpp/xmpp.igniterealtime.org; expecting: xmpp/igniterealtime.org
        at com.sun.security.sasl.digest.DigestMD5Server.validateClientResponse(DigestMD5Server.java:548)
        at com.sun.security.sasl.digest.DigestMD5Server.evaluateResponse(DigestMD5Server.java:244)
        at org.jivesoftware.openfire.net.SASLAuthentication.handle(SASLAuthentication.java:360)
        at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:176)
        at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:181)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:854)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:405)
        at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:235)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.compression.CompressionFilter.messageReceived(CompressionFilter.java:155)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.filter.ssl.SslHandler.flushScheduledEvents(SslHandler.java:323)
        at org.apache.mina.filter.ssl.SslFilter.messageReceived(SslFilter.java:520)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:48)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
        at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
        at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
        at java.lang.Thread.run(Thread.java:745)
{code}

{code}
2014.11.21 06:42:01 org.jivesoftware.openfire.net.DNSUtil - No SRV record found for: _xmpp-server._tcp.xmpp.igniterealtime.org
javax.naming.NameNotFoundException: DNS name not found [response code 3]; remaining name '_xmpp-server._tcp.xmpp.igniterealtime.org'
        at com.sun.jndi.dns.DnsClient.checkResponseCode(DnsClient.java:654)
        at com.sun.jndi.dns.DnsClient.isMatchResponse(DnsClient.java:572)
        at com.sun.jndi.dns.DnsClient.doUdpQuery(DnsClient.java:421)
        at com.sun.jndi.dns.DnsClient.query(DnsClient.java:210)
        at com.sun.jndi.dns.Resolver.query(Resolver.java:81)
        at com.sun.jndi.dns.DnsContext.c_getAttributes(DnsContext.java:430)
        at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_getAttributes(ComponentDirContext.java:231)
        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:139)
        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:127)
        at javax.naming.directory.InitialDirContext.getAttributes(InitialDirContext.java:142)
        at org.jivesoftware.openfire.net.DNSUtil.srvLookup(DNSUtil.java:192)
        at org.jivesoftware.openfire.net.DNSUtil.resolveXMPPDomain(DNSUtil.java:124)
        at org.jivesoftware.openfire.session.LocalOutgoingServerSession.createOutgoingSession(LocalOutgoingServerSession.java:218)
        at org.jivesoftware.openfire.session.LocalOutgoingServerSession.authenticateDomain(LocalOutgoingServerSession.java:161)
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.sendPacket(OutgoingSessionPromise.java:262)
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.run(OutgoingSessionPromise.java:239)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
2014.11.21 06:42:01 org.jivesoftware.openfire.net.DNSUtil - No SRV record found for: _jabber._tcp.xmpp.igniterealtime.org
{code}

{code}
2014.11.21 06:42:01 org.jivesoftware.openfire.server.OutgoingSessionPromise - OutgoingSessionPromise: Error sending packet to remote server: 
<iq type=""get"" to=""xmpp.igniterealtime.org"" id=""mir_48"" from=""redeyes@igniterealtime.org/Miranda"">
  <query xmlns=""http://jabber.org/protocol/disco#info""/>
</iq>
java.lang.Exception: Failed to create connection to remote server
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.sendPacket(OutgoingSessionPromise.java:275)
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.run(OutgoingSessionPromise.java:239)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
{code}

I have been running a test instance from a 13 November build and it does not appear to have this issue, so some change after that date may be to blame.  Obviously, this is blocking us from releasing a beta :(",,,,,No,,,,,0|i00uov:,No,"12/05/14 10:16 PM;akrherz;This change https://github.com/igniterealtime/Openfire/commit/ff30b90b3ce81dfd1a3cf6f612ca24aa54988f1f#diff-ddeb2cb1fd4ab0e500c9256290045b57  and the recent update to MINA 2.0.9 are my suspicion, but am unsure.",12/08/14 08:29 PM;akrherz;@Tom found that attempting to connect with Psi with connection compression enabled triggers this bug.,12/08/14 10:28 PM;tevans;The problem appears to be related to this issue in MINA: https://issues.apache.org/jira/browse/DIRMINA-995,12/09/14 01:56 AM;tevans;I have submitted a patch to the MINA team which I believe will address the C2S locking issue we have been experiencing. I also have some related cleanup within out own MINA integration code which I will provide via PR shortly.,12/09/14 02:40 PM;akrherz;PR has been merged and Igniterealtime's Openfire is running with this patch included!  Thanks so much Tom!,12/09/14 02:52 PM;akrherz;Gonna mark this as resolved as initial testing looks good.  Can reopen if necessary.,"01/10/15 12:16 AM;tevans;Additional work needed, [PR#151|https://github.com/igniterealtime/Openfire/pull/151] submitted.",01/16/15 05:42 PM;tevans;Fix has been merged into master ... will continue to monitor.,,,,
Character encoding issue in BOSH,OF-918,20347,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Critical,Fixed,guus,guus,guus,6/16/2015 17:56,11/27/2015 18:20,3/21/2020 16:10,10/19/2015 11:45,3.10.0,3.10.1,3.10.2,,,3.10.3,4.0.0,,,0,,,,,,"Users experience character encoding issues after an upgrade to Openfire 3.10.0.

Client (connected through BOSH) sends:
 
{code:xml}<body rid='528003' sid='704378c4' xmlns='http://jabber.org/protocol/httpbind' key='c3e31c36f8aa8e290404fd5b1a60e3141fe94dae' ><message xmlns=""jabber:client"" type=""groupchat"" to=""uhpo7nlfigk1inhr@conference.xxxxxxxx.com""><body>Hö hö</body></message></body>{code}
 
Server replies with:
 
{code:xml}<body xmlns='http://jabber.org/protocol/httpbind'><message xmlns=""jabber:client"" type=""groupchat"" to=""zxa5b07ekt6gn6a8@xxxxxxxx.com/uhpo7nlfigk1inhr"" from=""uhpo7nlfigk1inhr@conference.xxxxxxxx.com/Florian""><body>H�� h��</body></message></body>{code}",,,,,No,,,,https://community.igniterealtime.org/thread/56029,0|i0129r:,No,"10/12/15 01:49 PM;guus;So far, I am unable to reproduce the issue using jsjac (connecting to a local server running 3.11.0 Alpha) and Candy (connecting to igniterealtime.org, which is running 3.10.3 Alpha)","10/13/15 02:48 PM;fsailer;I downloaded 3.11.0 Alpha, installed in on my test system and still see this error. I have nginx configured as reverse proxy in front of openfire. Same setup works fine with 3.9.3. Is there anything i could do to help trace down this bug? Providing log files maybe?","10/16/15 02:22 PM;fsailer;I made some tests and figured out that i can fix the issue by adding ""-Dfile.encoding=UTF-8"" as option to the JVM. (On Ubuntu i added this to /etc/default/openfire). I hope this helps...","10/19/15 11:24 AM;guus;That was helpful Florian, thanks.

I've found the cause of the problem: when reading HTTP data from the client, an explicit character set is not defined, causing Java to fall back to the system default.

A pull request that addresses this issue is available here: https://github.com/igniterealtime/Openfire/pull/318

I was unable to merge the 3.10-based pull request into master neatly. I've created a second pull request for master here: https://github.com/igniterealtime/Openfire/pull/319",,,,,,,,
"stanza with multiple ""to"" attributes generated after restart",OF-870,20120,Bug,Reopened,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,,guus,akrherz,akrherz,1/28/2015 15:46,9/27/2019 16:49,3/21/2020 15:36,,3.10.0,,,,,,,MUC,,1,,,,,,"Rebooted ignite01 today to apply errata, which restarts openfire of course.  When openfire came back up, it was generating this stanza

{code:xml}
<message xmlns=""jabber:client"" type=""groupchat"" from=""open_chat@conference.igniterealtime.org/admin"" to=""5d67c041@igniterealtime.org/5d67c041"" to=""mhterres@jabber.org/Propus_LTSP""><body>hai every one</body><delay xmlns=""urn:xmpp:delay"" stamp=""2015-01-26T12:02:54.286Z"" from=""abc2893c@igniterealtime.org/abc2893c""/><x xmlns=""jabber:x:delay"" stamp=""20150126T12:02:54"" from=""abc2893c@igniterealtime.org/abc2893c""/></message>
{code}

Note the the message element has two 'to' attributes. Unsure of how this could happen.",,,,,No,,,,,0|i011br:,No,"10/30/15 11:38 PM;akrherz;Well, I have not seen this recently, perhaps the issue still exists, but will close until somebody notices it again","05/31/19 01:50 PM;guus;This happened to me on my local laptop. I wanted to test something, and created a room with two participants (via the admin console). I then tried joining and rejoining the chat, when suddenly, this started to occur. The problem for me was a message that was stored in the in-memory message history strategy for the muc, that's stored to denote the last subject change.",,,,,,,,,,
Chunked encoding in BOSH should not occur,OF-908,20233,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,,wroot,wroot,4/25/2015 9:00,1/7/2019 2:49,3/21/2020 16:10,1/7/2019 2:49,3.10.0,,,,,,,BOSH,,0,bosh,chrome,chunked,encoding,large,"I'm using BOSH (from Strophe on Chrome 42) into an OpenFire 3.10.0 server.  Small packets are working fine.  But as packet sizes get larger, around 27K we start to see OpenFire returning Transfer-Encoding: chunked.   That works (although is not supposed to be happening based on recent fixes).  However, once the packets get a bit larger, we are frequently seeing errors in Chrome where it is reporting:  ERR_INVALID_CHUNKED_ENCODING.  From what I understand, this probably suggests that Chrome thinks that the chunks are not being properly terminated with CRLF.

I saw OF-885 in 3.10.0 and think that perhaps this may be related.","BOSH, Chrome 42, Strophe",,,OF-885,No,,,,https://discourse.igniterealtime.org/t/openfire-3-10-0-chunked-transfer-encoding/78741,0|i010zj:,No,"04/25/15 03:59 PM;guus;Chunked encoding should be prevented, period.","04/26/15 10:08 PM;guus;Explicitly setting Content-Length headers should prevent chunked encoding from occurring - which at first glance did not appear to be true for Openfire.

However, when explicitly disabling compression, results appear to be good.","11/02/15 05:16 PM;akrherz;Guus, I forget where we left off with this painful experience.  Didn't we declare victory in 3.10.1 release?","12/17/15 03:31 PM;guus;Nope - with compression enabled, this still occurs. It's a bug (in the compression filter of Jetty, which is a dreadful project to get patches submitted to since they went the Eclipse way. Lots of hoops, fire, jumping involved. :/

Instant update: we did apply some fixes, if I recall correctly. The compression-related problem is one that still needs fixing.

A valid workaround for the problem is: disable compression.",01/05/16 12:07 PM;guus;I had another look. The newer Jetty (which we're not yet using) uses another compression filter implementation. Let's tackle this issue after we upgrade Jetty.,"11/13/17 02:59 PM;akrherz;To anybody watching this issue, is it still valid?","01/07/19 02:49 AM;akrherz;I don't think this issue is valid anymore, we can reopen if somebody says it is!",,,,,
Asterisk-IM plugin blocks client login,OF-911,20247,Bug,Closed,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Moved to GH,dwd,wroot,wroot,5/5/2015 3:44,1/4/2019 16:25,3/21/2020 16:10,1/4/2019 16:25,3.10.0,3.10.2,,,,,,Plugins,,1,asterisk,asterisk-im,login_problem,,,"Openfire 3.10.0 can't accept clients logins when Asterisk-IM 1.4 plugin is enabled on the server.

Maybe we should consider *removing* this plugin from the Downloads page as it is 8 years old, nobody is working on it and now it is not compatible with the newest Openfire code.

Spark logs:
WARNING: Exception in Login:
Connection failed. No response from server.: 

Openfire errors log:
sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.logicalcobwebs.proxool.WrappedConnection.invoke(WrappedConnection.java:162)
at org.logicalcobwebs.proxool.WrappedConnection.intercept(WrappedConnection.java:87)
at $java.sql.Wrapper$$EnhancerByProxool$$6dcceaa9.prepareStatement(<generated>)
at org.jivesoftware.phone.database.DbPhoneDAO.getPhoneServers(DbPhoneDAO.java:625)
at org.jivesoftware.phone.BasePhoneManager.getPhoneServers(BasePhoneManager.java:105)
at org.jivesoftware.phone.jsp.phone_002dsettings_jsp._jspService(org.jivesoftware.phone.jsp.phone_002dsettings_jsp:178)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
at org.jivesoftware.openfire.container.PluginServlet.handleJSP(PluginServlet.java:294)
at org.jivesoftware.openfire.container.PluginServlet.service(PluginServlet.java:107)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:808)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1669)
at org.jivesoftware.admin.PluginFilter.doFilter(PluginFilter.java:78)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.jivesoftware.admin.AuthCheckFilter.doFilter(AuthCheckFilter.java:159)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)
at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.jivesoftware.util.LocaleFilter.doFilter(LocaleFilter.java:74)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.jivesoftware.util.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:50)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.jivesoftware.admin.PluginFilter.doFilter(PluginFilter.java:78)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.jivesoftware.admin.AuthCheckFilter.doFilter(AuthCheckFilter.java:159)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)
at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)
at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
at org.eclipse.jetty.server.Server.handle(Server.java:497)
at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)
at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)
at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
at java.lang.Thread.run(Unknown Source) 

This might be the main reason. When installing this plugin, Launcher throws:
Missing database schema for asterisk-im. Attempting to install...
asterisk-im - Database update failed. Please manually upgrade your database.
Exception in thread ""C2S-Thread-1"" java.lang.AbstractMethodError
	at org.jivesoftware.openfire.event.SessionEventDispatcher.dispatchEvent(SessionEventDispatcher.java:90)
	at org.jivesoftware.openfire.handler.IQBindHandler.handleIQ(IQBindHandler.java:161)
	at org.jivesoftware.openfire.handler.IQHandler.process(IQHandler.java:65)
	at org.jivesoftware.openfire.IQRouter.handle(IQRouter.java:380)
	at org.jivesoftware.openfire.IQRouter.route(IQRouter.java:123)
	at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:76)
	at org.jivesoftware.openfire.net.StanzaHandler.processIQ(StanzaHandler.java:330)
	at org.jivesoftware.openfire.net.ClientStanzaHandler.processIQ(ClientStanzaHandler.java:93)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:295)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:187)
	at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:189)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:854)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:405)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:235)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.ssl.SslHandler.flushScheduledEvents(SslHandler.java:319)
	at org.apache.mina.filter.ssl.SslFilter.messageReceived(SslFilter.java:520)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
	at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
	at java.lang.Thread.run(Unknown Source)
Exception in thread ""LegacySSL-Thread-2"" java.lang.AbstractMethodError
	at org.jivesoftware.openfire.event.SessionEventDispatcher.dispatchEvent(SessionEventDispatcher.java:90)
	at org.jivesoftware.openfire.handler.IQBindHandler.handleIQ(IQBindHandler.java:161)
	at org.jivesoftware.openfire.handler.IQHandler.process(IQHandler.java:65)
	at org.jivesoftware.openfire.IQRouter.handle(IQRouter.java:380)
	at org.jivesoftware.openfire.IQRouter.route(IQRouter.java:123)
	at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:76)
	at org.jivesoftware.openfire.net.StanzaHandler.processIQ(StanzaHandler.java:330)
	at org.jivesoftware.openfire.net.ClientStanzaHandler.processIQ(ClientStanzaHandler.java:93)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:295)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:187)
	at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:189)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:854)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:405)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:235)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.ssl.SslHandler.flushScheduledEvents(SslHandler.java:319)
	at org.apache.mina.filter.ssl.SslFilter.messageReceived(SslFilter.java:520)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
	at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
	at java.lang.Thread.run(Unknown Source)
Exception in thread ""C2S-Thread-2"" java.lang.AbstractMethodError
	at org.jivesoftware.openfire.event.SessionEventDispatcher.dispatchEvent(SessionEventDispatcher.java:90)
	at org.jivesoftware.openfire.handler.IQBindHandler.handleIQ(IQBindHandler.java:161)
	at org.jivesoftware.openfire.handler.IQHandler.process(IQHandler.java:65)
	at org.jivesoftware.openfire.IQRouter.handle(IQRouter.java:380)
	at org.jivesoftware.openfire.IQRouter.route(IQRouter.java:123)
	at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:76)
	at org.jivesoftware.openfire.net.StanzaHandler.processIQ(StanzaHandler.java:330)
	at org.jivesoftware.openfire.net.ClientStanzaHandler.processIQ(ClientStanzaHandler.java:93)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:295)
	at org.jivesoftware.openfire.net.StanzaHandler.process(StanzaHandler.java:187)
	at org.jivesoftware.openfire.nio.ConnectionHandler.messageReceived(ConnectionHandler.java:189)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:854)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:109)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:405)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:235)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.filter.ssl.SslHandler.flushScheduledEvents(SslHandler.java:319)
	at org.apache.mina.filter.ssl.SslFilter.messageReceived(SslFilter.java:520)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:542)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$6(DefaultIoFilterChain.java:538)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:943)
	at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:74)
	at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
	at java.lang.Thread.run(Unknown Source)",,,,,No,,,,https://discourse.igniterealtime.org/t/asterisk-im-plugin-causes-users-not-to-be-able-to-login-after-upgrade-to-3-10/64616,0|i0113b:,No,06/23/15 03:17 PM;wroot;Just updating that 3.10.2 has the same problem.,06/23/15 04:10 PM;akrherz;I have removed the plugin from the downloads page in the interim.,07/03/15 01:18 PM;speedy;rebuilding the plugin with smack 3.4.1 seems to get things working again.  I posted a test build https://community.igniterealtime.org/thread/56076 if anyone wants to try it out.,"11/18/16 07:23 PM;akrherz;@speedy, you want to PR this change?",01/04/19 04:25 PM;akrherz;migrated to https://github.com/igniterealtime/asterisk-im/issues/4,,,,,,,
Openfire doesn't load user names with multi-byte characters from LDAP/AD,OF-1305,21824,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,guus,speedy,speedy,3/22/2017 20:14,3/29/2017 15:08,3/21/2020 16:10,3/29/2017 15:08,3.10.0,,,,,4.1.4,,,,0,,,,,,"Openfire doesn't load cyrillic user names from LDAP/AD . Per the forum post, it appears to have been introduced after 3.9.3. likely introduced in https://issues.igniterealtime.org/browse/OF-830

 ",,,,OF-830,No,,,,https://community.igniterealtime.org/thread/56378,0|i015ov:,No,,,,,,,,,,,,
Banning users from room does not result in proper exit,OF-1040,20728,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,guus,guus,1/12/2016 10:37,1/12/2016 14:02,3/21/2020 16:10,1/12/2016 14:02,3.10.0,3.10.1,3.10.2,3.10.3,4.0.0,4.0.1,4.1.0,MUC,,0,,,,,,"When a user is banned from a MUC room, an incorrect presence gets sent and the user is not completely removed from the room.

Pidgin is giving me some trouble reproducing this error - the user that I ban does appear to be removed from the room judging by Pidgins feedback. However, when observing the Openfire admin console, the user is still in.

A pull request that addresses this issue is provided here: https://github.com/igniterealtime/Openfire/pull/508",,,,OF-179,No,,,,,0|i011p3:,No,01/12/16 10:40 AM;guus;This issue appears to be introduced by the fix for OF-179,"01/12/16 02:02 PM;guus;PR was merged with master, cherry-picked to 4.0 branch.",,,,,,,,,,
Private Storage should return an error if feature is disabled,OF-915,20340,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,redeyes,akrherz,akrherz,6/8/2015 13:11,11/27/2015 18:20,3/21/2020 16:10,6/8/2015 13:11,3.10.0,,,,,4.0.0,,Core,,0,,,,,,"https://github.com/igniterealtime/Openfire/pull/228

Private storage should return an error if this feature is disabled within Openfire.",,,,,No,,,,,0|i012av:,No,,,,,,,,,,,,
lib/log4j.xml should be denoted as a config file in the installers,OF-913,20333,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,akrherz,akrherz,akrherz,5/29/2015 17:59,11/27/2015 18:20,3/21/2020 16:10,6/15/2015 12:28,3.10.0,,,,,4.0.0,,Core,,0,,,,,,"Currently, the lib/log4j.xml file is not denoted as a 'config file' within RPM, so when users install a new RPM, any changes they made to log4j.xml are destroyed.  So lets

#  review log4j.xml settings in other installers
# mark it as a config file for RPM",,,,,No,,,,,0|i0118f:,No,"05/29/15 06:17 PM;akrherz;https://github.com/igniterealtime/Openfire/pull/222 created, was unsure what to do with debian.",,,,,,,,,,,
SSO does not work with Openfire + Java 8,OF-906,20228,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,akrherz,akrherz,4/21/2015 12:39,11/27/2015 18:20,3/21/2020 16:10,6/21/2015 17:33,3.10.0,,,,,4.0.0,,Core,,0,sso,,,,,"I've had some time to mess with openfire and java 8.  It looks like it indeed breaks sso .  I believe this is because openfire uses DES . DES is disabled by default in java 8.  It can be enabled by adding allow_weak_crypto=true in the krb5.ini/krb5.conf.  However, even after adding this, I'm still unable to get SSO back up and running.  reverting back to java 7 on the server, and everything works like a champ.
 
I'll do some more testing to see if I can come up with a work around, but DES now being considered somewhat insecure, and Java 7 coming up on EOL, it might be a good time to see if a dev can look into this

speedy reports that latest Java 7 update (7u80) also breaks SSO: https://community.igniterealtime.org/thread/55310","Java 7u80+, Java 8",,,OF-477,No,,,,https://community.igniterealtime.org/message/247685#247685,0|i010rz:,No,06/04/15 05:47 PM;wroot;It has been reported that GSSAPI part of OF-477 part makes SSO work with Openfire + Java 8.,"06/21/15 05:23 PM;speedy;This can probably be closed now, because of https://github.com/igniterealtime/Openfire/pull/230 being applied to OF-477",,,,,,,,,,
ISE attempting to write data to a closed/closing session,OF-903,20222,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,tevans,akrherz,akrherz,4/10/2015 18:45,7/28/2015 17:21,3/21/2020 16:10,7/28/2015 17:21,3.10.0,,,,,3.10.3,,Core,,5,,,,,,"Using the current master build, I see tracebacks like so.  These happen when by coded bot quickly (and probably uncleanly) disconnects from the server.

{code}
2015.04.10 12:18:53 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <presence type=""unavailable"" from=""iembot_ingest@weather.im/pirep_20150407194011"" to=""iembot_ingest@weather.im/new_watch_20150324195807""/>
2015.04.10 12:18:53 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.IllegalStateException: Connection closed
	at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:264)
	at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
	at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
	at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
	at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
	at org.jivesoftware.openfire.SessionManager.broadcastPresenceToOtherResources(SessionManager.java:663)
	at org.jivesoftware.openfire.roster.Roster.broadcastPresence(Roster.java:642)
	at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUpdate(PresenceUpdateHandler.java:308)
	at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:162)
	at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
	at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
	at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
	at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
	at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
	at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClose(SessionManager.java:1242)
	at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection.java:240)
	at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:222)
	at org.jivesoftware.openfire.nio.ConnectionHandler.sessionClosed(ConnectionHandler.java:115)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionClosed(DefaultIoFilterChain.java:793)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:504)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterChain.java:500)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:923)
	at org.apache.mina.core.filterchain.IoFilterAdapter.sessionClosed(IoFilterAdapter.java:88)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:504)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterChain.java:500)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:923)
	at org.apache.mina.filter.codec.ProtocolCodecFilter.sessionClosed(ProtocolCodecFilter.java:367)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:504)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$2(DefaultIoFilterChain.java:500)
	at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:923)
	at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:109)
	at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
	at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
	at java.lang.Thread.run(Thread.java:745)
{code}",,,,,No,,,,,0|i012bj:,No,"06/24/15 03:49 PM;akrherz;Current message with 3.10.2

{code}
2015.06.24 00:54:55 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <presence to=""guus.der.kinderen@igniterealtime.org/mobile"" from=""flo@freakempire.de"" type=""error""><error code=""404
"" type=""cancel""><remote-server-not-found xmlns=""urn:ietf:params:xml:ns:xmpp-stanzas""/></error></presence>
2015.06.24 00:54:55 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:316)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.returnErrorToSender(OutgoingSessionPromise.java:318)
        at org.jivesoftware.openfire.server.OutgoingSessionPromise$PacketsProcessor.run(OutgoingSessionPromise.java:242)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
{code}

{code}
2015.06.24 00:54:56 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <presence from=""open_chat@conference.igniterealtime.org/Guus"" to=""guus.der.kinderen@igniterealtime.org/mobile"" type=""unavailable""><x xmlns=""http://jabber.org/protocol/muc#user""><item jid=""guus.der.kinderen@igniterealtime.org/mobile"" affiliation=""owner"" role=""none""/></x></presence>
2015.06.24 00:54:56 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:316)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:170)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:65)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRole.send(LocalMUCRole.java:266)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.broadcast(LocalMUCRoom.java:1155)
        at org.jivesoftware.openfire.muc.cluster.BroadcastPresenceRequest$1.run(BroadcastPresenceRequest.java:71)
        at org.jivesoftware.openfire.muc.cluster.MUCRoomTask.execute(MUCRoomTask.java:85)
        at org.jivesoftware.openfire.muc.cluster.BroadcastPresenceRequest.run(BroadcastPresenceRequest.java:69)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.broadcastPresence(LocalMUCRoom.java:1106)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.leaveRoom(LocalMUCRoom.java:826)
        at org.jivesoftware.openfire.muc.spi.LocalMUCUser.process(LocalMUCUser.java:552)
        at org.jivesoftware.openfire.muc.spi.LocalMUCUser.process(LocalMUCUser.java:197)
        at org.jivesoftware.openfire.muc.spi.MultiUserChatServiceImpl.processPacket(MultiUserChatServiceImpl.java:331)
        at org.jivesoftware.openfire.component.InternalComponentManager$RoutableComponents.process(InternalComponentManager.java:591)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToComponent(RoutingTableImpl.java:401)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:243)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:170)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUnavailableForDirectedPresences(PresenceUpdateHandler.java:489)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:163)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClose(SessionManager.java:1242)
        at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection.java:292)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:275)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:224)
        at org.jivesoftware.openfire.nio.NIOConnection.deliverRawText(NIOConnection.java:396)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:246)
        at org.jivesoftware.openfire.nio.NIOConnection.close(NIOConnection.java:224)
        at org.jivesoftware.openfire.nio.ConnectionHandler.sessionClosed(ConnectionHandler.java:107)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionClosed(DefaultIoFilterChain.java:642)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:382)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$900(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:750)
        at org.apache.mina.core.filterchain.IoFilterAdapter.sessionClosed(IoFilterAdapter.java:88)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:382)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$900(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:750)
        at org.apache.mina.filter.codec.ProtocolCodecFilter.sessionClosed(ProtocolCodecFilter.java:369)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:382)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$900(DefaultIoFilterChain.java:47)
        at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionClosed(DefaultIoFilterChain.java:750)
        at org.apache.mina.core.filterchain.IoFilterEvent.fire(IoFilterEvent.java:109)
        at org.apache.mina.core.session.IoEvent.run(IoEvent.java:63)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTask(OrderedThreadPoolExecutor.java:769)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.runTasks(OrderedThreadPoolExecutor.java:761)
        at org.apache.mina.filter.executor.OrderedThreadPoolExecutor$Worker.run(OrderedThreadPoolExecutor.java:703)
        at java.lang.Thread.run(Thread.java:745)
{code}","07/02/15 08:14 AM;carol;Hi, I have exactly the same problem with 3.10.2. We are using SSO configuration, have any updates for that?
{code}
2015.07.02 15:22:40 org.jivesoftware.openfire.nio.NIOConnection - Failed to deliver packet: <presence to=""username@xmpp.domain.com/84a12ecf"" from=""groupname@conference.xmpp.domain.com/username"" type=""unavailable""><priority>1</priority><c xmlns=""http://jabber.org/protocol/caps"" node=""http://pidgin.im/"" hash=""sha-1"" ver=""I22W7CegORwdbnu0ZiQwGpxr0Go=""/><x xmlns=""http://jabber.org/protocol/muc#user""><item jid=""username@xmpp.domain.com/84a12ecf"" affiliation=""none"" role=""none""/><status code=""110""/></x></presence>
2015.07.02 15:22:40 org.jivesoftware.openfire.session.LocalSession - Internal server error
java.lang.IllegalStateException: Connection closed
        at org.jivesoftware.openfire.nio.NIOConnection.deliver(NIOConnection.java:316)
        at org.jivesoftware.openfire.session.LocalClientSession.deliver(LocalClientSession.java:857)
        at org.jivesoftware.openfire.session.LocalSession.process(LocalSession.java:289)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToLocalDomain(RoutingTableImpl.java:354)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:239)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:170)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:65)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRole.send(LocalMUCRole.java:266)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.broadcast(LocalMUCRoom.java:1153)
        at org.jivesoftware.openfire.muc.cluster.BroadcastPresenceRequest$1.run(BroadcastPresenceRequest.java:71)
        at org.jivesoftware.openfire.muc.cluster.MUCRoomTask.execute(MUCRoomTask.java:85)
        at org.jivesoftware.openfire.muc.cluster.BroadcastPresenceRequest.run(BroadcastPresenceRequest.java:69)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.broadcastPresence(LocalMUCRoom.java:1106)
        at org.jivesoftware.openfire.muc.spi.LocalMUCRoom.leaveRoom(LocalMUCRoom.java:826)
        at org.jivesoftware.openfire.muc.spi.LocalMUCUser.process(LocalMUCUser.java:552)
        at org.jivesoftware.openfire.muc.spi.LocalMUCUser.process(LocalMUCUser.java:197)
        at org.jivesoftware.openfire.muc.spi.MultiUserChatServiceImpl.processPacket(MultiUserChatServiceImpl.java:331)
        at org.jivesoftware.openfire.component.InternalComponentManager$RoutableComponents.process(InternalComponentManager.java:591)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routeToComponent(RoutingTableImpl.java:401)
        at org.jivesoftware.openfire.spi.RoutingTableImpl.routePacket(RoutingTableImpl.java:243)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:170)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.broadcastUnavailableForDirectedPresences(PresenceUpdateHandler.java:489)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:163)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:137)
        at org.jivesoftware.openfire.handler.PresenceUpdateHandler.process(PresenceUpdateHandler.java:201)
        at org.jivesoftware.openfire.PresenceRouter.handle(PresenceRouter.java:148)
        at org.jivesoftware.openfire.PresenceRouter.route(PresenceRouter.java:84)
        at org.jivesoftware.openfire.spi.PacketRouterImpl.route(PacketRouterImpl.java:84)
        at org.jivesoftware.openfire.SessionManager$ClientSessionListener.onConnectionClose(SessionManager.java:1242)
        at org.jivesoftware.openfire.nio.NIOConnection.notifyCloseListeners(NIOConnection.java:292)
{code}","07/06/15 09:25 AM;ArthurBorsboom;Confirming bug

* Linux
* JDK 1.7.0_76
* OpenFire 3.10.2
* No LDAP
","07/07/15 02:03 PM;guus;Caused here: https://github.com/igniterealtime/Openfire/commit/9205a2f1cf266300e6b23128ee789f66998762c2#diff-41f9e6754333c4e8a9e9f8ad048e68ceL258

The recursion prevention prevents every packet after the first one that is delivered to a closed/closing connection to cause this error.",07/07/15 03:51 PM;tevans;Hmmm ... not great. The referenced patch was mine - I'll take a closer/second look at the original recursion problem (OF-857).,"07/28/15 05:19 PM;tevans;Submitted [PR#260|https://github.com/igniterealtime/Openfire/pull/260], pending review.",,,,,,
SSLv2 Hello is rejected; prevents some clients connecting,OF-907,20232,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,dwd,dwd,4/24/2015 9:04,7/20/2015 12:42,3/21/2020 16:10,6/16/2015 17:24,3.10.0,,,,,3.10.1,,,,2,ssl,sslv2,,,,"Spark, Psi, and some other clients use the (very outdated) SSLv2 Hello when negotiating TLS. Currently this is rejected by Openfire, so these clients can no longer negotiate any TLS at all.",,,,,No,,,,https://igniterealtime.jiveon.com/thread/55358,0|i010wn:,No,"04/25/15 09:41 AM;wroot;I have added a link to forum thread most probably related to it, though many other threads about Spark not able to login probably are related too. But Spark 2.7.0 works fine with Openfire 3.10.0, and i have TLS set as required and SSL disabled. Psi is also connecting fine for me (on Windows box with self-signed certificates generated by Openfire).","04/27/15 05:13 AM;it2000;Is https://github.com/igniterealtime/Openfire/pull/207/files the proper fix for this issue?
+            // ... but accept a SSLv2 Hello on the server
+            filter.setEnabledProtocols(new String[]{""SSLv2Hello"", ""TLSv1"", ""TLSv1.1"", ""TLSv1.2""});

If I got it right some Psi clients have problems to connect while the server connections are fine. So this fix wouldn't help. I'd prefer system properties to modify the supported protocols if needed and keep the current default as is (""TLSv1"", ""TLSv1.1"", ""TLSv1.2"") as it makes no sense to re-enable support for Poodle.","07/20/15 12:33 PM;SimonWaters;Apologies for revisiting old topic.

Clients requesting SSLv2 violated RFCs 6120 (XMPP: Core) and 6176 (Prohibiting SSLv2 - no really there is a whole RFC prohibiting the use of SSL v2)

Were the bugs reported to client software projects (yes I know most of them are long dead).",,,,,,,,,
MUC de-synchronization issues,OF-910,20244,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,dwd,dwd,dwd,5/1/2015 15:47,6/16/2015 17:24,3/21/2020 16:10,6/16/2015 17:24,3.10.0,,,,,3.10.1,,MUC,,0,muc,,,,,"In various cases, a MUC room will believe an occupant exists when they've left, and a newly joined occupant is considered already joined, and therefore won't get the full set of occupants.",,,,,No,,,Medium,,0|i0111j:,No,,,,,,,,,,,,
GZipFilter fails on Async BOSH servlet,OF-897,20156,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Major,Fixed,guus,guus,guus,3/20/2015 20:11,3/20/2015 20:15,3/21/2020 16:10,3/20/2015 20:15,3.10.0,,,,,3.10.0,,,,0,,,,,,"After switching the BOSH servlet implementation to an async Servlet implementation (OF-885), HTTP compression fails.

The existing implementation uses a filter that is incompatible with an async servlet. Jetty provides a async-compatible one, which should be used.",,,,OF-885,No,,,,,0|i00v07:,No,03/20/15 08:15 PM;guus;Replaced with AsyncGZipFilter.,,,,,,,,,,,
Pubsub notification/delivery issues in cluster mode,OF-871,20121,Bug,Open,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,,tevans,tevans,tevans,1/29/2015 18:02,11/13/2017 14:26,3/21/2020 16:10,,3.10.0,,,,,,,PubSub,,0,,,,,,See linked community report. It appears that pubsub notifications are not being correctly delivered to the other cluster members. ,,,,,No,,,,https://discourse.igniterealtime.org/t/pubsub-notifications-in-clustered-environment-problem/60387,0|i00u0f:,No,11/02/15 05:05 PM;akrherz;Anybody watching this ticket able to comment on it?,,,,,,,,,,,
BOSH client connections sometimes failing,OF-890,20148,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,Cannot Reproduce,guus,akrherz,akrherz,3/6/2015 15:03,12/19/2016 20:17,3/21/2020 16:10,12/19/2016 20:17,3.10.0,,,,,,,Core,,0,,,,,,"For tracking and posterity, after merging Guus's change for OF-885, BOSH clients like Pidgin are not able to cleanly connect.  Relevant server logs are likely

{code}
2015.03.06 08:11:30 org.eclipse.jetty.server.HttpChannel - /http-bind/
java.lang.IllegalStateException: state=EOF
        at org.eclipse.jetty.server.HttpInput.setReadListener(HttpInput.java:375)
        at org.jivesoftware.openfire.http.HttpBindServlet.doPost(HttpBindServlet.java:150)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
        at org.jivesoftware.openfire.http.HttpBindServlet.service(HttpBindServlet.java:114)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:808)
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:587)
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:189)
        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
        at org.eclipse.jetty.server.Server.handleAsync(Server.java:553)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:347)
        at org.eclipse.jetty.server.HttpChannel.run(HttpChannel.java:261)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
        at java.lang.Thread.run(Thread.java:745)
2015.03.06 08:11:30 org.eclipse.jetty.util.thread.QueuedThreadPool -
java.lang.IllegalStateException: committed
        at org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:772)
        at org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:781)
        at org.eclipse.jetty.server.HttpChannel.handleException(HttpChannel.java:472)
        at org.eclipse.jetty.server.HttpConnection$HttpChannelOverHttp.handleException(HttpConnection.java:576)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:398)
        at org.eclipse.jetty.server.HttpChannel.run(HttpChannel.java:261)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
        at java.lang.Thread.run(Thread.java:745)
2015.03.06 08:11:30 org.eclipse.jetty.util.thread.QueuedThreadPool - Unexpected thread death: org.eclipse.jetty.util.thread.QueuedThreadPool$3@21a7333c in Jetty-QTP-BOSH{STARTED,8<=22<=200,i=1,q=0}
{code}",,,,OF-885,No,,,,,0|i010tr:,No,"03/13/15 05:04 PM;akrherz;So I made a change to Ignite's Openfire to allow proxied traffic from apache to reach openfire via a LAN connection and not the WAN...  This error is now gone and Ignite's candy interface works again :(

Pidgin/bosh issues continue, but no errors are now logged from it.",12/19/16 08:17 PM;akrherz;Not reproducing with current 4.1 beta and Pidgin.  Can reopen if somebody reproduces trouble with current releases....,,,,,,,,,,
BOSH response should return ack attribute,OF-909,20241,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,Fixed,tevans,tevans,tevans,4/28/2015 20:26,5/4/2015 16:00,3/21/2020 16:10,5/4/2015 16:00,3.10.0,,,,,3.10.1,,BOSH,,0,,,,,,"For release 3.10.0 we moved to an async non-blocking I/O implementation for the BOSH component. However, with this new build in many cases the ""ack"" attribute is not being returned in the response <body/> element. This attribute may be used by clients to verify which of the sent messages have been successfully received by the server.

Refer to the [BOSH specs|http://xmpp.org/extensions/xep-0124.html#ack] for more information.",,,,,No,,,,,0|i010vz:,No,04/28/15 09:11 PM;tevans;PR pending: https://github.com/igniterealtime/Openfire/pull/209,,,,,,,,,,,
BOSH connector does not properly restart after a configuration change,OF-877,20127,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Minor,Fixed,tevans,tevans,tevans,2/4/2015 17:09,2/19/2015 21:48,3/21/2020 16:10,2/19/2015 21:48,3.10.0,,,,,3.10.0,,,,0,bosh,http_bind,,,,The restart logic in the HttpBindManager is a little wonky. Working on a fix already.,,,,,No,,,,https://community.igniterealtime.org/thread/53966,0|i00ufz:,No,02/04/15 09:57 PM;tevans;PR #172.,"02/18/15 11:30 PM;dele;This fix has broken the current ability of plugins to create a web context.
I am currently investigating...
","02/19/15 10:13 AM;dele;The problem is moving the creation of the contexts handler collection out of the constructor. 

HandlerCollection collection = new HandlerCollection();

It stops plugins from adding their web services to the collection before the server is started in start().

Reverting back to previous behaviour","02/19/15 09:48 PM;tevans;Applied Dele's patch, confirmed plugins can update the shared web context.",,,,,,,,
NPE in MINAStatCollector,OF-878,20128,Bug,Resolved,OF,Openfire,software,guus,"Open-Source Java XMPP (Jabber) server. <p>

<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/bug_red.gif"" width=""24"" height=""24""></td><td><b>Need to report a bug?</b> All bug reports should be made in the <a href=""https://discourse.igniterealtime.org"">discussion forums</a>. A developer will then create an issue in the bug tracker and schedule it to be fixed in an upcoming release.</td></tr></table>

<br>
<table border=""0""><tr><td valign=""top""><img src=""https://www.igniterealtime.org/images/vote.png"" width=""24"" height=""24""></td><td><b>Vote for your favorite issues.</b> Issues voted on by the community are given higher priority. View <a href=""https://www.igniterealtime.org/issues/secure/IssueNavigator.jspa?mode=hide&requestId=10200"">the list</a> of open issues by votes.</td></tr></table>
",http://www.igniterealtime.org/projects/openfire,Trivial,Fixed,tevans,tevans,tevans,2/4/2015 21:42,2/4/2015 21:58,3/21/2020 16:10,2/4/2015 21:58,3.10.0,,,,,3.10.0,,,,0,,,,,,This appears to be a race condition where the removeSession() method gets invoked before the addSession() is completed.,,,,,No,,,,https://community.igniterealtime.org/thread/54379,0|i00u6f:,No,"02/04/15 09:43 PM;tevans;2015.02.04 09:57:59 org.apache.mina.util.DefaultExceptionMonitor - Unexpected exception.
java.lang.NullPointerException
  at org.apache.mina.management.MINAStatCollector.removeSession(MINAStatCollector.ja va:212)
  at org.apache.mina.management.MINAStatCollector.access$100(MINAStatCollector.java: 39)
  at org.apache.mina.management.MINAStatCollector$1.sessionDestroyed(MINAStatCollect or.java:76)
  at org.apache.mina.core.service.IoServiceListenerSupport.fireSessionDestroyed(IoSe rviceListenerSupport.java:250)
  at org.apache.mina.core.polling.AbstractPollingIoProcessor.removeNow(AbstractPolli ngIoProcessor.java:604)
  at org.apache.mina.core.polling.AbstractPollingIoProcessor.removeSessions(Abstract PollingIoProcessor.java:564)
  at org.apache.mina.core.polling.AbstractPollingIoProcessor.access$12(AbstractPolli ngIoProcessor.java:554)
  at org.apache.mina.core.polling.AbstractPollingIoProcessor$Processor.run(AbstractP ollingIoProcessor.java:1129)
  at org.apache.mina.util.NamePreservingRunnable.run(NamePreservingRunnable.java:64)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
  at java.lang.Thread.run(Thread.java:744)",02/04/15 09:58 PM;tevans;PR #173,,,,,,,,,,
